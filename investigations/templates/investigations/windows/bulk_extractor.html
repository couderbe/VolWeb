<div>
  <button type="button" class="btn btn-dark border border-dark"
    onclick="DownloadBulk('{{case.id}}','{{case.name}}')">Download</button>

</div>

<form id="form1" action="{% url 'download_bulk' %}" method="POST">
  {% csrf_token %}
  {{dl_dump_form.id}}
</form>


<script>
  function DownloadBulk(dump_id, filename) {
    const csrf = document.getElementsByName('csrfmiddlewaretoken');
    const fd = new FormData();
    fd.append('csrfmiddlewaretoken', csrf[0].value);
    fd.append('id', dump_id);
    $.ajax({
      type: 'POST',
      url: "{% url 'download_bulk' %}",
      enctype: 'multipart/form-data',
      data: fd,
      beforeSend: function () {
        $('#proc-message').html("Requesting download...");
        $('.toast-proc').toast('show');
      },
      success: function (data) {
        //Convert the Byte Data to BLOB object.
        var blob = new Blob([data], { type: "application/octetstream" });
        //Check the Browser type and download the File.
        var isIE = false || !!document.documentMode;
        if (isIE) {
          window.navigator.msSaveBlob(blob, filename + ".zip");
        } else {
          var url = window.URL || window.webkitURL;
          link = url.createObjectURL(blob);
          var a = $("<a />");
          a.attr("download", filename);
          a.attr("href", link);
          $("body").append(a);
          a[0].click();
          $("body").remove(a);
        }
      },
      error: function (error) {
        $('#proc-error-message').html("Download failed ! :(");
        $('.toast-proc-error').toast('show');
      },
      cache: false,
      contentType: false,
      processData: false
    });
  }
</script>